# 查询部门

> 严格按照开发流程来开发，先分析需求：
>
> 打开'部门管理'首先涉及到部门的查询操作：

![image-20240423200608200](assets/image-20240423200608200.png)

> 然后看接口文档，请求路径/depts，请求方式GET，请求参数无：

![image-20240423200747831](assets/image-20240423200747831.png)

> 响应数据为JSON类型，其中code参数是必须项：

![image-20240423200824794](assets/image-20240423200824794.png)

> 响应数据示例：

![image-20240423200854186](assets/image-20240423200854186.png)

> 定义一个查询员工消息的控制器，其请求方式是GET，那么使用@GetMapping，查询的员工信息是多个我们封装在List集合中。返回值要求是JSON，我们返回统一响应实体类Result，由@ResponsesBody将其封装成JSON格式，Controller层负责调用Service层的逻辑实现，使用自动注入，注入Service实例：

![image-20240423220034672](assets/image-20240423220034672.png)

> 定义Service层的查询员工信息的接口方法，并实现该方法，Service层负责功能的逻辑实现，同时调用Dao层的数据，使用自动注入，注入Mapper实例：

![image-20240423220317762](assets/image-20240423220317762.png)

![image-20240423220328222](assets/image-20240423220328222.png)

> 定义查询员工信息的方法，简单查询，我们使用注解的方式执行SQL，将查询的数据封装在List中：

![image-20240423220543679](assets/image-20240423220543679.png)

> 访问：

![image-20240423221709691](assets/image-20240423221709691.png)

> 不使用GET请求，则访问失败：

![image-20240423221732344](assets/image-20240423221732344.png)

![image-20240423221740460](assets/image-20240423221740460.png)



# 前后端联调

> 启动前端工程，前端工程以部署在nginx中，以管理员运行，端口是90：

![image-20240424192418185](assets/image-20240424192418185.png)

> 打开部门管理模块：



# 删除部门

> 需求：

![image-20240424203342074](assets/image-20240424203342074.png)

> 点击删除按钮，弹出确认框，提示信息，确认则删除，取消则不做任何操作。
>
> 需求文档：

![image-20240424203503418](assets/image-20240424203503418.png)

> 请求参数：

![image-20240424203538376](assets/image-20240424203538376.png)

> 这种请求风格是Restful风格，我们在后端要用{}路径参数。
>
> 响应格式：

![image-20240424203724576](assets/image-20240424203724576.png)

> 控制层：

![image-20240424205047782](assets/image-20240424205047782.png)

> service层：

![image-20240424205123435](assets/image-20240424205123435.png)

![image-20240424205107153](assets/image-20240424205107153.png)

> Mapper接口方法：

![image-20240424205156469](assets/image-20240424205156469.png)

> 测试，删除id=5的部门：

![image-20240424205416102](assets/image-20240424205416102.png)

![image-20240424205442327](assets/image-20240424205442327.png)

> 数据表：

![image-20240424205831063](assets/image-20240424205831063.png)



# 新增部门

> 需求：

![image-20240425190230215](assets/image-20240425190230215.png)

> 接口需求：

![image-20240425190422289](assets/image-20240425190422289.png)

> POST请求，请求参数：

![image-20240425190454016](assets/image-20240425190454016.png)

> 响应类型：

![image-20240425190515656](assets/image-20240425190515656.png)

> 声明控制器，接收JSON参数用实体类时需要声明@RequestBody注释：

![image-20240425194341746](assets/image-20240425194341746.png)

> service中补充缺失的字段，这部分是逻辑实现，应该在service中实现，不建议在控制器中实现：

![image-20240425194449810](assets/image-20240425194449810.png)

![image-20240425194500059](assets/image-20240425194500059.png)

> 插入SQL、方法：

![image-20240425194553068](assets/image-20240425194553068.png)

> 测试：

![image-20240425194611354](assets/image-20240425194611354.png)

![image-20240425194631285](assets/image-20240425194631285.png)



# Controller层提取请求路径

> 上面实现的3个控制器，其共同的特点是请求路径的前缀都是/depts，我们可以将功能的路径提取出来放在@RequestMapping中，然后将注释放在类上，方法上提取后剩余的部分保持不变：

![image-20240425194911547](assets/image-20240425194911547.png)

> 一个完整的请求路径。应该是类上的@RequestMapping的value属性+方法上的@RequestMapping的value属性。

![image-20240425195107191](assets/image-20240425195107191.png)

![image-20240425195115699](assets/image-20240425195115699.png)

![image-20240425195343834](assets/image-20240425195343834.png)

![image-20240425195129556](assets/image-20240425195129556.png)



# 编辑部门

> 首先要根据id查询出对应的部门信息，然后回显：
>
> 根据id查询部门的接口需求：

![image-20240425212828858](assets/image-20240425212828858.png)

> 请求参数：

![image-20240425212836595](assets/image-20240425212836595.png)

> 响应数据：

![image-20240425212922775](assets/image-20240425212922775.png)

> 控制器：

![image-20240425213034847](assets/image-20240425213034847.png)

> service：

![image-20240425213100656](assets/image-20240425213100656.png)

![image-20240425213108921](assets/image-20240425213108921.png)

> 查询SQL、方法：

![image-20240425213244727](assets/image-20240425213244727.png)

> 测试：

![image-20240425213327148](assets/image-20240425213327148.png)

![image-20240425213343880](assets/image-20240425213343880.png)

> 编辑部门的接口需求：

![image-20240425213416282](assets/image-20240425213416282.png)

> 参数：

![image-20240425213431216](assets/image-20240425213431216.png)

> 响应：

![image-20240425213444249](assets/image-20240425213444249.png)

> 控制层：

![image-20240425213507793](assets/image-20240425213507793.png)

> service：

![image-20240425213525328](assets/image-20240425213525328.png)

![image-20240425213535968](assets/image-20240425213535968.png)

> 编辑SQL，用的是XML实现，方法：

![image-20240425213615268](assets/image-20240425213615268.png)

![image-20240425214112667](assets/image-20240425214112667.png)

> 测试：

![image-20240425214147972](assets/image-20240425214147972.png)

![image-20240425214206494](assets/image-20240425214206494.png)